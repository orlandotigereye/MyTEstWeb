<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub è·¯å¾‘åµæ¸¬å™¨ - é‡‘å…‰ç‰ˆ</title>
    <style>
        :root { --gold-primary: #ffd700; --gold-dark: #b8860b; --text-size: 0.5rem; }
        body { 
            background: radial-gradient(circle, #ffec8b, #daa520, #8b6508); 
            background-attachment: fixed; color: #333; font-family: sans-serif; 
            font-size: var(--text-size); margin: 0; padding: 10px; 
            display: flex; flex-direction: column; align-items: center; 
        }
        .container { 
            width: 100%; max-width: 900px; background: rgba(255, 255, 255, 0.95); 
            border: 2px solid var(--gold-primary); box-shadow: 0 0 15px #ffd700; 
            border-radius: 8px; padding: 10px; box-sizing: border-box; 
        }
        .header { text-align: center; border-bottom: 2px solid var(--gold-primary); margin-bottom: 8px; }
        .path-input-group { display: flex; gap: 5px; margin-bottom: 10px; }
        input { flex: 1; font-size: var(--text-size); padding: 3px; border: 1px solid var(--gold-dark); }
        .btn { padding: 4px 10px; background: linear-gradient(to bottom, #ffd700, #b8860b); color: white; border: none; border-radius: 3px; cursor: pointer; font-size: var(--text-size); }
        .list-group { list-style: none; padding: 0; margin: 0; border: 1px solid #ddd; background: #fff; }
        .list-item { display: flex; align-items: center; padding: 5px; border-bottom: 1px solid #eee; }
        .list-item:hover { background: #fffacd; }
        .list-item a { text-decoration: none; color: #0056b3; flex: 1; }
        .log-box { background: #000; color: #0f0; padding: 10px; font-size: 0.45rem; border-radius: 4px; max-height: 150px; overflow-y: auto; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>âœ¨ GitHub æª”æ¡ˆè·¯å¾‘å…¨è‡ªå‹•åµæ¸¬ âœ¨</h1>
        <button class="btn" id="dl-btn">â¬‡ï¸ ä¸‹è¼‰æ­¤ç¨‹å¼</button>
    </div>

    <div class="path-input-group">
        <input type="text" id="custom-path" value="public/public" placeholder="è¼¸å…¥è³‡æ–™å¤¾è·¯å¾‘ (ä¾‹å¦‚: public)">
        <button class="btn" onclick="fetchCustomPath()">ç«‹å³è·³è½‰</button>
    </div>

    <div id="status-msg" style="background:#fff3cd; padding:5px; margin-bottom:5px; text-align:center;">æ­£åœ¨æƒææ ¹ç›®éŒ„çµæ§‹...</div>

    <ul id="file-list" class="list-group"></ul>

    <div class="log-box" id="debug-log">ç³»çµ±æ—¥èªŒé–‹å•Ÿä¸­...</div>
</div>

<script>
const CFG = {
    OWNER: 'orlandotigereye',
    REPO: 'mytestweb'
};

const logBox = document.getElementById('debug-log');
const listEl = document.getElementById('file-list');

function addLog(msg, isError = false) {
    const time = new Date().toLocaleTimeString();
    logBox.innerHTML += `<div style="color:${isError?'red':'#0f0'}">[${time}] ${msg}</div>`;
    logBox.scrollTop = logBox.scrollHeight;
}

// æ ¸å¿ƒæŠ“å–å‡½æ•¸
async function fetchDirectory(path) {
    addLog(`é€£ç·šè‡³è·¯å¾‘: /${path}...`);
    document.getElementById('status-msg').innerText = `æ­£åœ¨è¼‰å…¥: /${path}`;
    listEl.innerHTML = '';

    try {
        const response = await fetch(`https://api.github.com/repos/${CFG.OWNER}/${CFG.REPO}/contents/${path}`);
        
        if (!response.ok) {
            const errData = await response.json();
            addLog(`âŒ API å ±éŒ¯: ${response.status} - ${errData.message}`, true);
            document.getElementById('status-msg').innerText = `âŒ è·¯å¾‘å¤±æ•—: /${path}`;
            return;
        }

        const data = await response.json();
        addLog(`âœ… æˆåŠŸ! ç™¼ç¾ ${data.length} å€‹é …ç›®ã€‚`);
        document.getElementById('status-msg').innerText = `âœ… ç•¶å‰è·¯å¾‘: /${path}`;

        data.forEach(item => {
            const li = document.createElement('li');
            li.className = 'list-item';
            const isDir = item.type === 'dir';
            
            // å¦‚æœæ˜¯è³‡æ–™å¤¾ï¼Œé»æ“Šå¾Œæœƒé‡æ–°åµæ¸¬è©²è·¯å¾‘
            const linkAction = isDir 
                ? `href="javascript:void(0)" onclick="fetchDirectory('${item.path}')"` 
                : `href="https://${CFG.OWNER}.github.io/${CFG.REPO}/${item.path}" target="_blank"`;

            li.innerHTML = `
                <span>${isDir ? 'ğŸ“' : 'ğŸ“„'}</span>&nbsp;
                <a ${linkAction} style="${isDir?'font-weight:bold; color:var(--gold-dark);':''}">${item.name}</a>
                ${isDir ? ' <small>(é»æ“Šé€²å…¥)</small>' : ''}
            `;
            listEl.appendChild(li);
        });

    } catch (err) {
        addLog(`âŒ ç¶²è·¯éŒ¯èª¤: ${err.message}`, true);
    }
}

function fetchCustomPath() {
    const p = document.getElementById('custom-path').value.trim();
    fetchDirectory(p);
}

document.getElementById('dl-btn').onclick = () => {
    const blob = new Blob([document.documentElement.outerHTML], { type: 'text/html' });
    const a = Object.assign(document.createElement('a'), { href: URL.createObjectURL(blob), download: 'finder.html' });
    a.click();
};

// åˆå§‹å¾æ ¹ç›®éŒ„é–‹å§‹ï¼Œè®“ä½¿ç”¨è€…è‡ªå·±é¸é€²å»
fetchDirectory('');
</script>
</body>
</html>
