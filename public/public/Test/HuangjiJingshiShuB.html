<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>çš‡æ¥µç¶“ä¸–ãƒ»æ²³æ´›ç†æ•¸å…¨ç¯‡æ¼”ç®—ç³»çµ±</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
:root {
    --gold-primary: #ffd700;
    --gold-dark: #b8860b;
    --gold-light: #fff9e6;
    --bg-gold: radial-gradient(circle, #fff8e1 0%, #ffd700 100%);
    --font-size: 0.5rem;
}

body {
    font-family: "PingFang TC", "STKaiti", serif;
    background: var(--bg-gold);
    background-attachment: fixed;
    color: #3e2723;
    margin: 0;
    padding: 5px;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-x: hidden;
}

.container {
    width: 100%;
    max-width: 900px;
    background: rgba(255, 255, 255, 0.95);
    border: 3px double var(--gold-dark);
    border-radius: 15px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.3);
    padding: 15px;
    box-sizing: border-box;
}

h1 {
    font-size: 1.2rem;
    text-align: center;
    color: var(--gold-dark);
    margin: 10px 0;
    letter-spacing: 2px;
}

.tiny-text {
    font-size: var(--font-size) !important;
    line-height: 1.5;
}

/* åˆ†é ç³»çµ± */
.tabs {
    display: flex;
    flex-wrap: wrap;
    border-bottom: 2px solid var(--gold-dark);
    margin-bottom: 10px;
}

.tab {
    flex: 1;
    min-width: 80px;
    padding: 8px;
    text-align: center;
    font-size: var(--font-size);
    cursor: pointer;
    background: #fdf5e6;
    border: 1px solid #ddd;
    border-bottom: none;
    transition: 0.3s;
}

.tab.active {
    background: var(--gold-dark);
    color: white;
    font-weight: bold;
}

.page {
    display: none;
}

.page.active {
    display: block;
}

.card {
    background: #fff;
    border: 1px solid var(--gold-primary);
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 8px;
}

input, button, select {
    font-size: var(--font-size);
    padding: 5px;
    border: 1px solid var(--gold-dark);
    border-radius: 4px;
}

button {
    background: var(--gold-dark);
    color: white;
    cursor: pointer;
}

/* åœ–è¡¨ */
#vibration-svg {
    background: #fffef0;
    border: 1px solid #eee;
    width: 100%;
    height: 250px;
}

.hex-box {
    display: flex;
    flex-direction: column-reverse;
    width: 40px;
    height: 60px;
    margin: 5px auto;
}

.yao {
    height: 6px;
    width: 100%;
    margin: 1px 0;
}
.yao.yang { background: #333; }
.yao.yin { background: linear-gradient(to right, #333 42%, transparent 42%, transparent 58%, #333 58%); }

.example-btn {
    margin-right: 5px;
    margin-bottom: 5px;
    background: #a1887f;
}

#log-output {
    background: #fdfdfd;
    max-height: 300px;
    overflow-y: auto;
    border: 1px inset #ccc;
    padding: 5px;
}

#download-btn {
    position: fixed;
    bottom: 10px;
    right: 10px;
    padding: 10px;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    font-size: 0.4rem;
    z-index: 999;
}
</style>
</head>
<body>

<div class="container">
    <h1>ğŸº çš‡æ¥µç¶“ä¸–ãƒ»æ²³æ´›ç†æ•¸å…¨ç¯‡</h1>
    
    <div class="card">
        <div class="tiny-text">
            <b>æ•¸ç†è¼¸å…¥ï¼š</b>
            <input id="inputNum" type="number" value="1975" placeholder="è¼¸å…¥å¹´ä»½æˆ–ä»»æ„æ•¸">
            <button onclick="runCalculation()">æ¼”ç®—</button>
            <div style="margin-top:5px;">
                <b>æ­·å²å¯¦ä¾‹ï¼š</b>
                <button class="example-btn" onclick="setExample(1563)">è¬æ›†çš‡å¸</button>
                <button class="example-btn" onclick="setExample(1037)">è˜‡è»¾</button>
                <button class="example-btn" onclick="setExample(1011)">é‚µé›</button>
                <button class="example-btn" onclick="setExample(1912)">ä¸­è¯æ°‘åœ‹</button>
            </div>
        </div>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="switchTab(0)">åäºŒå·å…¨ç¯‡æ¨ç®—</div>
        <div class="tab" onclick="switchTab(1)">é«”ç”¨å¹³è¡¡åœ–</div>
        <div class="tab" onclick="switchTab(2)">ç™½è©±è¡Œç‚ºå‰‡</div>
        <div class="tab" onclick="switchTab(3)">å…ƒæœƒé‹ä¸–ç†</div>
    </div>

    <!-- é é¢ 0: å…¨ç¯‡æ¨ç®— -->
    <div id="page0" class="page active">
        <div class="card">
            <div class="tiny-text" id="calc-summary" style="font-weight:bold; color:#b8860b;"></div>
            <div id="log-output" class="tiny-text"></div>
        </div>
    </div>

    <!-- é é¢ 1: é«”ç”¨åœ–è¡¨ -->
    <div id="page1" class="page">
        <div class="card">
            <div class="tiny-text" style="margin-bottom:10px;"><b>ã€èƒ½é‡åˆ†ä½ˆï¼šé«”ç”¨æ¶ˆé•·æ›²ç·šã€‘</b></div>
            <div id="vibration-container">
                <svg id="vibration-svg"></svg>
            </div>
            <div id="graph-info" class="tiny-text" style="margin-top:10px;"></div>
        </div>
    </div>

    <!-- é é¢ 2: ç™½è©±è¡Œç‚º -->
    <div id="page2" class="page">
        <div id="behavior-content" class="tiny-text"></div>
    </div>

    <!-- é é¢ 3: ç†è«–ä¾æ“š -->
    <div id="page3" class="page">
        <div class="card tiny-text">
            <p><b>é‚µå­äº‘ï¼š</b>ã€Œä¸–ç•Œä¹‹å¤§ï¼Œçš†ç”±æ•¸å‡ºã€‚ã€</p>
            <p>1. <b>å…ƒæœƒé‹ä¸–ï¼š</b> 1å…ƒ=12æœƒ=360é‹=4320ä¸–ã€‚ä¸€ä¸–=30å¹´ã€‚</p>
            <p>2. <b>æ›æ°£æµè½‰ï¼š</b> æœ¬ç³»çµ±ä»¥ã€Œçš‡æ¥µç¶“ä¸–ã€å…ˆå¤©å…­åå››å¦æ–¹åœ“åœ–ç‚ºç¶“ï¼Œå»å››æ­£å¦ï¼ˆä¹¾å¤åé›¢ï¼‰ç‚ºç·¯ï¼Œæ¼”åŒ–å…­åç”²å­å¾ªç’°ã€‚</p>
            <p>3. <b>é«”ç”¨ï¼š</b> é«”è€…éœä¹Ÿï¼Œç”¨è€…å‹•ä¹Ÿã€‚åœ–è¡¨å‘ˆç¾æ•¸å€¼ä¹‹èµ·ä¼ï¼Œå³ç‚ºé«”ç”¨ä¹‹ç›ˆç¸®ã€‚</p>
        </div>
    </div>

    <div id="info-status" class="tiny-text" style="text-align:center; color: #b8860b;">ç³»çµ±å·²å°±ç·’ã€‚</div>
</div>

<button id="download-btn" onclick="downloadCode()">ä¸‹è¼‰<br>åŸå§‹ç¢¼</button>

<script>
/**
 * é‚µé›çš‡æ¥µç¶“ä¸–æ¼”ç®—æ ¸å¿ƒ
 * 1. è¼¸å…¥æ•¸å€¼è½‰ç‚ºã€Œèµ·æ•¸ã€
 * 2. è¨ˆç®—å°æ‡‰çš„å…ƒæœƒé‹ä¸–ç›¸ä½
 * 3. ç²å–å¦è±¡èˆ‡è¡Œç‚ºå»ºè­°
 */

const HEX_LIST = [
    { name: "å¾©", yao: [1,0,0,0,0,0], advice: "è¬ç‰©æ›´æ–°ä¹‹åˆï¼Œå®œéœä¸å®œå‹•ã€‚åƒç¨®å­åœ¨åœŸä¸­è“„åŠ›ã€‚", do: "åˆ¶å®šé•·æœŸè¨ˆç•«", dont: "æ€¥æ–¼æ±‚æˆ" },
    { name: "é ¤", yao: [1,0,0,0,0,1], advice: "æ…è¨€èªï¼Œç¯€é£²é£Ÿã€‚æ³¨é‡å…§åœ¨ä¿®é¤Šèˆ‡å½¢è±¡ã€‚", do: "é€²ä¿®èˆ‡é¤Šç”Ÿ", dont: "å£èˆŒæ˜¯é" },
    { name: "å±¯", yao: [1,0,0,0,1,0], advice: "åˆç”Ÿä¹‹é›£ï¼Œé›–ç„¶è‰±è¾›ä½†å……æ»¿å¸Œæœ›ï¼Œå®œå°‹æ±‚å”åŠ©ã€‚", do: "å°‹æ‰¾åˆä½œå¤¥ä¼´", dont: "ç¨è‡ªå†’éšª" },
    { name: "ç›Š", yao: [1,1,0,0,0,1], advice: "æä¸Šç›Šä¸‹ï¼Œåˆ©ä»–å³æ˜¯åˆ©å·±ã€‚æ“´å¤§æ ¼å±€ä¹‹æ™‚ã€‚", do: "å…¬ç›Šèˆ‡æŠ•è³‡", dont: "åå—‡è‡ªå®ˆ" },
    { name: "éœ‡", yao: [1,0,0,1,0,0], advice: "éœ‡é©šèˆ‡è­¦ç¤ºã€‚é¢å°çªç™¼ç‹€æ³éœ€å†·éœæ‡‰å°ã€‚", do: "å±æ©Ÿå‚™æ¡ˆ", dont: "é©šæ…Œå¤±æª" },
    { name: "å™¬å—‘", yao: [1,0,1,0,0,1], advice: "éšœç¤™å¿…é ˆæ¸…é™¤ï¼Œæ³•å¾‹èˆ‡è¦å‰‡çš„åŸ·è¡ŒæœŸã€‚", do: "è§£æ±ºé™³å¹´èˆŠæ¡ˆ", dont: "å„ªæŸ”å¯¡æ–·" },
    { name: "éš¨", yao: [1,0,0,1,1,0], advice: "éš¨é‡è€Œå®‰ï¼Œé †æ‡‰æ½®æµã€‚æ­¤æ™‚ä¸å®œé ˜å°ã€‚", do: "åŠ å…¥å¤§åœ˜éšŠ", dont: "å›ºåŸ·å·±è¦‹" },
    { name: "ç„¡å¦„", yao: [1,0,0,1,1,1], advice: "å®ˆæœ¬åˆ†ï¼Œä¸å¦„æƒ³ã€‚è¸å¯¦ç”Ÿæ´»å³æœ‰é©šå–œã€‚", do: "å±¥è¡Œæ‰¿è«¾", dont: "æŠ•æ©Ÿå–å·§" },
    { name: "æ˜å¤·", yao: [1,0,1,0,0,0], advice: "å…‰æ˜å—æï¼Œæ‰è¯è¢«å£“åˆ¶ï¼Œå®œéŸœå…‰é¤Šæ™¦ã€‚", do: "ä½èª¿åšäº‹", dont: "é¡¯æ“ºæ‹›å¿Œ" },
    { name: "è³", yao: [1,0,1,0,0,1], advice: "ä¿®é£¾èˆ‡åŒ…è£ã€‚æ³¨é‡æ–‡åŒ–åº•è˜Šèˆ‡ç¦®å„€ã€‚", do: "å½¢è±¡å…¬é—œ", dont: "è™›æœ‰å…¶è¡¨" },
    { name: "æ—¢æ¿Ÿ", yao: [1,0,1,0,1,0], advice: "å°åŠŸå‘Šæˆã€‚é˜²æ­¢æœ«è·¯å´©å£ï¼Œæª¢æŸ¥ç´°ç¯€ã€‚", do: "ç¶­è­·èˆ‡é˜²å®ˆ", dont: "å¤§æ„è¼•æ•µ" },
    { name: "å®¶äºº", yao: [1,0,1,1,0,1], advice: "å®¶åº­èˆ‡å…§éƒ¨åœ˜çµæ˜¯æ ¸å¿ƒã€‚å…ˆå®‰å…§å†å£¤å¤–ã€‚", do: "è™•ç†å®¶æ—äº‹å‹™", dont: "å¿½ç•¥å¾Œå‹¤" },
    { name: "è±", yao: [1,0,1,1,0,0], advice: "ç››å¤§ä¹‹æ™‚ã€‚ç‰©æ¥µå¿…åï¼Œå®œåœ¨å·”å³°å°‹é€€è·¯ã€‚", do: "è³‡æºå…±äº«", dont: "é©•å‚²è‡ªæ»¿" },
    { name: "é©", yao: [1,0,1,1,1,1], advice: "èˆŠè²Œæ›æ–°é¡ã€‚å¾¹åº•çš„è½‰å‹èˆ‡é©å‘½ã€‚", do: "æŠ€è¡“æ›´æ–°", dont: "å¢¨å®ˆæˆè¦" },
    { name: "åŒäºº", yao: [1,1,1,1,0,1], advice: "å°‹æ‰¾åŒé“ä¸­äººã€‚å»ºç«‹è·¨ç•Œè¯ç›Ÿã€‚", do: "å…¬é–‹åˆä½œ", dont: "æ’å¤–ç‹¹éš˜" },
    { name: "è‡¨", yao: [1,1,0,0,0,0], advice: "å¼·å‹¢ä¸Šå‡æœŸã€‚ç›£ç£èˆ‡æŒ‡å°ä»–äººã€‚", do: "ç©æ¥µé–‹æ‹“", dont: "é¬†æ‡ˆæ€ æ…¢" },
    { name: "æ", yao: [1,1,0,0,0,1], advice: "æ¸›æ³•ç”Ÿæ´»ã€‚æ¨æ£„ä¸å¿…è¦çš„è² æ“”ã€‚", do: "è‡ªæˆ‘æ§åˆ¶", dont: "è²ªåœ–äº«æ¨‚" },
    { name: "ç¯€", yao: [1,1,0,0,1,0], advice: "åˆ¶å®šæ¨™æº–èˆ‡ç•Œé™ã€‚è‡ªå¾‹æ–¹èƒ½è‡ªç”±ã€‚", do: "åˆ¶åº¦åŒ–ç®¡ç†", dont: "éåº¦æ”¾ç¸±" },
    { name: "ä¸­å­š", yao: [1,1,0,0,1,1], advice: "è‡³èª æ„Ÿå¤©ã€‚å»ºç«‹æ·±å±¤æ¬¡çš„ä¿¡ä»»ã€‚", do: "å¿ƒéˆå°è©±", dont: "è™›å½æ¬ºé¨™" },
    { name: "æ­¸å¦¹", yao: [1,1,0,1,1,0], advice: "ä½ç½®ä¸ç•¶ã€‚ä¸è¦æ€¥æ–¼é”æˆé•·æœŸå¥‘ç´„ã€‚", do: "é‡æ–°æª¢è¦–é—œä¿‚", dont: "æ€¥æ–¼æˆäº¤" },
    { name: "ç½", yao: [1,1,0,1,0,1], advice: "å·®ç•°èˆ‡éš”é›¢ã€‚æ±‚åŒå­˜ç•°ï¼Œå°‹æ‰¾å°å¹³è¡¡ã€‚", do: "ç¨ç«‹ç ”ç™¼", dont: "æ¿€çƒˆçˆ­è¾¯" },
    { name: "å…Œ", yao: [1,1,0,1,1,0], advice: "å’Œæ‚…èˆ‡æºé€šã€‚åˆ©æ–¼è«‡åˆ¤èˆ‡å‚³é”è³‡è¨Šã€‚", do: "å…¬é–‹æ¼”èªª", dont: "è¨€èªä¸­å‚·" },
    { name: "å±¥", yao: [1,1,0,1,1,1], advice: "å¦‚å±¥è™å°¾ã€‚æ‡‰å°æ¬Šå¨è¦æ¥µåº¦è¬¹æ…ã€‚", do: "å®Œå–„ç¦®æ³•", dont: "é ‚æ’é•·å®˜" },
    { name: "æ³°", yao: [1,1,1,0,0,0], advice: "é€šé †ç„¡ç¤™ã€‚é©åˆæ¨è¡Œå¤§è¦æ¨¡è¨ˆç•«ã€‚", do: "å…¨é¢æ“´å¼µ", dont: "éŒ¯å¤±æ™‚æ©Ÿ" },
    { name: "å¤§ç•œ", yao: [1,1,1,0,0,1], advice: "å·¨å¤§çš„ç©ç´¯ã€‚ä¸åªæ˜¯éŒ¢ï¼Œé‚„æœ‰æ‰å¾·ã€‚", do: "é€²éšè¨“ç·´", dont: "æ€¥åŠŸè¿‘åˆ©" },
    { name: "éœ€", yao: [1,1,1,0,1,0], advice: "é›²åœ¨å¤©ä¸Šï¼Œè€å¿ƒç­‰å¾…ã€‚æ™‚æ©Ÿåœ¨è·¯ä¸Šã€‚", do: "è“„å‹¢å¾…ç™¼", dont: "ç„¦èºå†’é€²" },
    { name: "å°ç•œ", yao: [1,1,1,0,1,1], advice: "å¾®å°èª¿æ•´ã€‚å±€éƒ¨æ€§çš„å„ªåŒ–ã€‚", do: "ç´°ç¯€å¾®èª¿", dont: "å¤§å‹•å¹²æˆˆ" },
    { name: "å¤§å£¯", yao: [1,1,1,1,0,0], advice: "åŠ›é‡å¼·å‹ã€‚å®œæ­¢å®œç©©ï¼Œé˜²æ­¢å¤±æ§ã€‚", do: "ç©©å¥æ¨é€²", dont: "è¡å‹•è¡Œäº‹" },
    { name: "å¤§æœ‰", yao: [1,1,1,1,0,1], advice: "å¯Œæœ‰å¤©ä¸‹ã€‚æ‡‰å¤©é †äººï¼Œå¤§å±€ç‚ºé‡ã€‚", do: "æ„Ÿæ©èˆ‡åˆ†äº«", dont: "ç¨ä½”åˆ©ç›Š" },
    { name: "å¤¬", yao: [1,1,1,1,1,0], advice: "æœæ–·è£æ’¤ã€‚æ¸…é™¤è² é¢æƒ…ç·’èˆ‡äººå“¡ã€‚", do: "å£¯å£«æ–·è…•", dont: "å„ªæŸ”å¯¡æ–·" },
    { name: "å§¤", yao: [0,1,1,1,1,1], advice: "ä¸æœŸè€Œé‡ã€‚è­¦æƒ•ä¸ç©©å®šçš„èª˜æƒ‘ã€‚", do: "é˜²ç¯„æœªç„¶", dont: "è¼•ä¿¡ä»–äºº" },
    { name: "å¤§é", yao: [0,1,1,1,1,0], advice: "è² æ“”éé‡ã€‚éœ€è¦å°‹æ‰¾æ ¸å¿ƒæ”¯æ’ã€‚", do: "å°‹æ±‚é—œéµæ”¯æŸ±", dont: "ç¡¬æ’æŠ˜æ–·" },
    { name: "é¼", yao: [0,1,1,1,0,1], advice: "å»ºç«‹åˆ¶åº¦ï¼Œç©©å›ºä¸‰è§’ã€‚æ¬ŠåŠ›æ›´æ–°ã€‚", do: "æ¶æ§‹é‡çµ„", dont: "åè½åä¿¡" },
    { name: "æ†", yao: [0,1,1,1,0,0], advice: "é•·æœŸå …æŒã€‚ä¸éš¨æ³¢é€æµã€‚", do: "å›ºæœ¬åŸ¹å…ƒ", dont: "è¦‹ç•°æ€é·" },
    { name: "å·½", yao: [0,1,1,0,1,1], advice: "æº«å’Œå¦‚é¢¨ã€‚åè¦†æºé€šé”æˆç›®æ¨™ã€‚", do: "ç§ä¸‹éŠèªª", dont: "å¼·ç¡¬ä»‹å…¥" },
    { name: "äº•", yao: [0,1,1,0,1,0], advice: "å®ˆä½æ ¹æºã€‚å°ˆæ¥­èƒ½åŠ›çš„æ·±åŒ–ã€‚", do: "æ‰æ ¹å°ˆæ¥­", dont: "é »ç¹æ›´æ›" },
    { name: "è ±", yao: [0,1,1,0,0,1], advice: "ä¿®æ­£éå¾€çš„éŒ¯èª¤ã€‚æ²»ç—…æ•‘äººã€‚", do: "å…§éƒ¨æ”¹é©", dont: "ç²‰é£¾å¤ªå¹³" },
    { name: "å‡", yao: [0,1,1,0,0,0], advice: "æ­¥æ­¥é«˜å‡ã€‚åˆ©æ–¼å°‹æ±‚ä¸Šä½è€…æ”¯æŒã€‚", do: "è‡ªæˆ‘æ¨è–¦", dont: "æ¶ˆæ¥µæ€ å·¥" },
    { name: "è¨Ÿ", yao: [0,1,0,1,1,1], advice: "çˆ­è­°èˆ‡ä¸å’Œã€‚æ­¢æç‚ºä¸Šã€‚", do: "æ³•å¾‹è«®è©¢", dont: "æ„æ°£ç”¨äº‹" },
    { name: "å›°", yao: [0,1,0,1,1,0], advice: "å—å›°ä¹‹æ™‚ã€‚ç£¨ç·´å¿ƒå¿—ï¼Œæ²ˆé»˜æ˜¯é‡‘ã€‚", do: "ç¯€å„‰åº¦æ—¥", dont: "éåº¦è§£é‡‹" },
    { name: "æœªæ¿Ÿ", yao: [0,1,0,1,0,1], advice: "æœ€å¾Œçš„è€ƒé©—ã€‚åŠŸæ•—å‚æˆåœ¨æ­¤ä¸€èˆ‰ã€‚", do: "ç²¾ç›Šæ±‚ç²¾", dont: "ææ—©æ…¶ç¥" },
    { name: "è§£", yao: [0,1,0,1,0,0], advice: "è§£æ±ºæ–¹æ¡ˆå‡ºç¾ã€‚å¿«é€Ÿè¡Œå‹•è„«å›°ã€‚", do: "åŸè«’èˆ‡èµ¦å…", dont: "æ‹–å»¶æ™‚é–“" },
    { name: "æ¸™", yao: [0,1,0,0,1,1], advice: "åŒ–è§£éš”é–¡ã€‚ç”¨ç²¾ç¥åŠ›é‡å‡èšå¤§å®¶ã€‚", do: "åœ˜é«”å‡èš", dont: "åˆ†å´©é›¢æ" },
    { name: "å", yao: [0,1,0,0,1,0], advice: "é‡é‡å±æ©Ÿã€‚èª ä¿¡æ˜¯å”¯ä¸€çš„å‡ºè·¯ã€‚", do: "è‰±è‹¦å¥®é¬¥", dont: "é‹Œè€Œèµ°éšª" },
    { name: "è’™", yao: [0,1,0,0,0,1], advice: "å•Ÿè’™å­¸ç¿’ã€‚è™›å¿ƒæ±‚æ•™ï¼Œä¸æ¥ä¸‹å•ã€‚", do: "åƒåŠ åŸ¹è¨“", dont: "è‡ªä»¥ç‚ºæ˜¯" },
    { name: "å¸«", yao: [0,1,0,0,0,0], advice: "çµ„ç¹”èˆ‡ç´€å¾‹ã€‚å‡ºå¸«è¦æœ‰æ­£ç•¶æ€§ã€‚", do: "å»ºç«‹æ¨™æº–", dont: "ç´€å¾‹é¬†æ•£" },
    { name: "é¯", yao: [0,0,1,1,1,1], advice: "é©æ™‚éš±é€€ã€‚ä¸åƒèˆ‡ç„¡è¬‚çˆ­é¬¥ã€‚", do: "åº¦å‡æˆ–é€€ä¼‘", dont: "æˆ€æ£§æ¬Šä½" },
    { name: "å’¸", yao: [0,0,1,0,1,1], advice: "æ„Ÿæ‡‰èˆ‡å¿ƒéˆå¥‘åˆã€‚æ³¨é‡ç¬¬ä¸€å°è±¡ã€‚", do: "æƒ…æ„Ÿæºé€š", dont: "åˆ©ç›Šè‡³ä¸Š" },
    { name: "æ—…", yao: [0,0,1,0,1,0], advice: "å®¢å±…ä»–é„‰ã€‚ä¿æŒè¬™éœï¼Œéˆæ´»è®Šé€šã€‚", do: "ç•°åœ°ç™¼å±•", dont: "é«˜èª¿ç‚«å¯Œ" },
    { name: "å°é", yao: [0,0,1,1,0,0], advice: "ç´°å¾®ééŒ¯ã€‚å®œä¸‹ä¸å®œä¸Šã€‚", do: "ç²¾æº–åŸ·è¡Œ", dont: "é‡å¿ƒå‹ƒå‹ƒ" },
    { name: "æ¼¸", yao: [0,0,1,0,1,1], advice: "å¾ªåºæ¼¸é€²ã€‚æ¬²é€Ÿå‰‡ä¸é”ã€‚", do: "æŒ‰éƒ¨å°±ç­", dont: "æ‹”è‹—åŠ©é•·" },
    { name: "è¹‡", yao: [0,0,1,0,1,0], advice: "è¡Œè·¯è‰±é›£ã€‚åçœä¸¦å°‹æ±‚å›é ­è·¯ã€‚", do: "æª¢è¨ç­–ç•¥", dont: "å¼·è¡Œæ¨é€²" },
    { name: "è‰®", yao: [0,0,1,0,0,1], advice: "æ­¢è§€èˆ‡å¹³éœã€‚ä¸å‹•å¦‚å±±ã€‚", do: "å†¥æƒ³ä¿®èº«", dont: "å¤šç®¡é–’äº‹" },
    { name: "è¬™", yao: [0,0,1,0,0,0], advice: "è¬™å—ç›Šã€‚è¶Šæœ‰æˆå°±è¶Šè¦è¬™å‘ã€‚", do: "åŠŸæˆä¸å±…", dont: "å‚²æ…¢ç„¡ç¦®" },
    { name: "å¦", yao: [0,0,0,1,1,1], advice: "é–‰å¡ä¸é€šã€‚èˆ‡å¤–ç•Œéš”çµ•ä¹‹æ„Ÿã€‚", do: "å„²å‚™é«”åŠ›", dont: "å¼·æ±‚åˆä½œ" },
    { name: "èƒ", yao: [0,0,0,1,1,0], advice: "äººæ‰èšèƒã€‚é©åˆå¤§å‹èšæœƒã€‚", do: "æ‹›è˜äººæ‰", dont: "å­¤å‚²é›¢ç¾¤" },
    { name: "æ™‰", yao: [0,0,0,1,0,1], advice: "å¦‚æ—¥åˆå‡ã€‚å—åˆ°é•·å®˜é‡ç”¨ã€‚", do: "ç©æ¥µè¡¨ç¾", dont: "è‡ªå‘ä¿å®ˆ" },
    { name: "è±«", yao: [0,0,0,1,0,0], advice: "å®‰æ¨‚èˆ‡é å‚™ã€‚å®œæ—©ä½œæ‰“ç®—ã€‚", do: "åˆ¶å®šé ç®—", dont: "ç©ç‰©å–ªå¿—" },
    { name: "è§€", yao: [0,0,0,0,1,1], advice: "è§€æ‘©èˆ‡æ´—æ»Œã€‚å­¸ç¿’ä»–äººçš„é•·è™•ã€‚", do: "è€ƒå¯Ÿå­¸ç¿’", dont: "èµ°é¦¬çœ‹èŠ±" },
    { name: "æ¯”", yao: [0,0,0,0,1,0], advice: "è¦ªå¯†ä¾é™„ã€‚å°‹æ‰¾å¼·å¤§çš„æ ¸å¿ƒã€‚", do: "å»ºç«‹è¯ç›Ÿ", dont: "çŒ¶è±«ä¸æ±º" },
    { name: "å‰", yao: [0,0,0,0,0,1], advice: "æ¥µåº¦å‰è½ã€‚å®ˆä½æ ¹åŸºï¼Œç­‰å¾…å¯’å†¬éå»ã€‚", do: "ä¿å®ˆé˜²ç¦¦", dont: "æœ€å¾Œä¸€æ" },
    { name: "å¤", yao: [0,0,0,0,0,0], advice: "åœ°å‹¢å¤ï¼Œå›å­ä»¥åšå¾·è¼‰ç‰©ã€‚", do: "åŒ…å®¹ä¸€åˆ‡", dont: "ä¸»å‹•çˆ­é¬¥" }
];

const GANZHI = ["ç”²å­","ä¹™ä¸‘","ä¸™å¯…","ä¸å¯","æˆŠè¾°","å·±å·³","åºšåˆ","è¾›æœª","å£¬ç”³","ç™¸é…‰","ç”²æˆŒ","ä¹™äº¥","ä¸™å­","ä¸ä¸‘","æˆŠå¯…","å·±å¯","åºšè¾°","è¾›å·³","å£¬åˆ","ç™¸æœª","ç”²ç”³","ä¹™é…‰","ä¸™æˆŒ","ä¸äº¥","æˆŠå­","å·±ä¸‘","åºšå¯…","è¾›å¯","å£¬è¾°","ç™¸å·³","ç”²åˆ","ä¹™æœª","ä¸™ç”³","ä¸é…‰","æˆŠæˆŒ","å·±äº¥","åºšå­","è¾›ä¸‘","å£¬å¯…","ç™¸å¯","ç”²è¾°","ä¹™å·³","ä¸™åˆ","ä¸æœª","æˆŠç”³","å·±é…‰","åºšæˆŒ","è¾›äº¥","å£¬å­","ç™¸ä¸‘","ç”²å¯…","ä¹™å¯","ä¸™è¾°","ä¸å·³","æˆŠåˆ","å·±æœª","åºšç”³","è¾›é…‰","å£¬æˆŒ","ç™¸äº¥"];

function switchTab(idx) {
    document.querySelectorAll('.tab').forEach((t, i) => t.classList.toggle('active', i === idx));
    document.querySelectorAll('.page').forEach((p, i) => p.classList.toggle('active', i === idx));
}

function setExample(val) {
    document.getElementById('inputNum').value = val;
    runCalculation();
}

function runCalculation() {
    const num = parseInt(document.getElementById('inputNum').value);
    if (isNaN(num)) return;

    const output = document.getElementById('log-output');
    output.innerHTML = "";

    // çš‡æ¥µç¶“ä¸–å…ƒæœƒé‹ä¸–æ¨å°
    // ä»¥ 1984 å¹´ç‚ºç”²å­å¹´åŸºæº– (åŸºæº–é»ï¼šä¸Šå…ƒç”²å­)
    const baseYear = 1984;
    const diff = num - baseYear;
    const idx = (diff % 60 + 60) % 60;
    
    // è¨ˆç®—å€¼å¹´å¦ (å…­åå¦å¾ªç’°)
    const hexIdx = idx % HEX_LIST.length;
    const currentHex = HEX_LIST[hexIdx];

    // ç”ŸæˆåäºŒå·æ¨ç®—æ•¸æ“š (é æ¸¬æœªä¾† 12 å€‹é€±æœŸ/å¹´)
    let summaryHTML = `ç•¶å‰æ•¸ç†åæ¨™ï¼š${GANZHI[idx]} ï½œ å€¼å¹´å¦ï¼š${currentHex.name}`;
    document.getElementById('calc-summary').innerHTML = summaryHTML;

    for (let i = 0; i < 60; i++) {
        const loopIdx = (idx + i) % 60;
        const hIdx = (idx + i) % HEX_LIST.length;
        const hex = HEX_LIST[hIdx];
        const year = num + i;
        
        const row = document.createElement('div');
        row.className = 'tiny-text';
        row.style.borderBottom = "1px solid #eee";
        row.style.padding = "3px 0";
        row.innerHTML = `<b>è¥¿å…ƒ ${year} (${GANZHI[loopIdx]})</b>ï¼šå€¼å¹´å¦ã€Œ${hex.name}ã€ - ${hex.advice.substring(0, 25)}...`;
        output.appendChild(row);
    }

    // æ›´æ–°è¡Œç‚ºé é¢
    renderBehavior(currentHex);

    // ç¹ªè£½ D3 åœ–è¡¨
    drawD3Graph(idx);
}

function renderBehavior(hex) {
    const target = document.getElementById('behavior-content');
    target.innerHTML = `
        <div class="card">
            <div style="display:flex; align-items:center; gap:15px;">
                <div class="hex-box">
                    ${hex.yao.map(y => `<div class="yao ${y===1?'yang':'yin'}"></div>`).join('')}
                </div>
                <div>
                    <p style="font-weight:bold; font-size:0.7rem;">å€¼å¹´å¦ï¼š${hex.name}</p>
                    <p>å¦æ°£è§£èªï¼š${hex.advice}</p>
                </div>
            </div>
        </div>
        <div class="card">
            <p><b>âœ¨ é»ƒé‡‘è¡Œç‚ºï¼ˆå®œï¼‰ï¼š</b> ${hex.do}</p>
            <p><b>âš ï¸ é¿å‘æŒ‡å—ï¼ˆå¿Œï¼‰ï¼š</b> ${hex.dont}</p>
        </div>
    `;
}

function drawD3Graph(activeIdx) {
    const svg = d3.select("#vibration-svg");
    svg.selectAll("*").remove();
    
    const width = document.getElementById('vibration-svg').clientWidth;
    const height = 250;
    const padding = 30;

    // é«”ç”¨æ³¢å‹•æ•¸æ“šï¼šåŸºæ–¼æ²³æ´›ç†æ•¸ 60 å¾ªç’°çš„å‹•æ…‹æ­£å¼¦
    const data = Array.from({length: 60}, (_, i) => ({
        x: i,
        // é‚µæ°ç†æ•¸æ³¢å‹•ï¼šé«”(å¤§æ³¢)+ç”¨(å°æ³¢)
        y: 50 + 30 * Math.sin((i / 60) * Math.PI * 2) + 15 * Math.cos((i / 10) * Math.PI)
    }));

    const xScale = d3.scaleLinear().domain([0, 59]).range([padding, width - padding]);
    const yScale = d3.scaleLinear().domain([0, 100]).range([height - padding, padding]);

    // ç¹ªè£½èƒŒæ™¯ç·š
    svg.append("line")
        .attr("x1", padding).attr("y1", yScale(50))
        .attr("x2", width - padding).attr("y2", yScale(50))
        .attr("stroke", "#ccc").attr("stroke-dasharray", "4");

    const line = d3.line()
        .x(d => xScale(d.x))
        .y(d => yScale(d.y))
        .curve(d3.curveCardinal);

    svg.append("path")
        .datum(data)
        .attr("fill", "none")
        .attr("stroke", "var(--gold-dark)")
        .attr("stroke-width", 2)
        .attr("d", line);

    // é«˜äº®ç•¶å‰é»
    const current = data[activeIdx];
    svg.append("circle")
        .attr("cx", xScale(current.x))
        .attr("cy", yScale(current.y))
        .attr("r", 8)
        .attr("fill", "red")
        .attr("stroke", "white")
        .attr("stroke-width", 2);

    svg.append("text")
        .attr("x", xScale(current.x))
        .attr("y", yScale(current.y) - 15)
        .attr("text-anchor", "middle")
        .attr("font-size", "10px")
        .text("ç•¶å‰ç›¸ä½");

    document.getElementById('graph-info').innerHTML = `
        ç•¶å‰èƒ½é‡å‹•é‡ï¼š${Math.round(current.y)} åˆ»ã€‚åæ˜ ã€Šçš‡æ¥µç¶“ä¸–ã€‹ä¸­ã€Œé«”ç”¨æ¶ˆé•·ã€ä¹‹å‹•èƒ½å¹³è¡¡ã€‚
    `;
}

function downloadCode() {
    const html = document.documentElement.outerHTML;
    const blob = new Blob([html], {type: 'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "HuangJiJingShi_System.html";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}

// åˆå§‹åŒ–
window.onload = runCalculation;
</script>
</body>
</html>
