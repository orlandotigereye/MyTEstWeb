<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>çš‡æ¥µç¶“ä¸–ï½œä¸‰ç·šæ™‚é–“å‹•èƒ½ç³»çµ±</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{background:#0e1116;color:#eee;font-family:system-ui;padding:14px}
h1,h2,h3{color:#ffd700}
.card{background:#1a1f2a;border-radius:10px;padding:14px;margin:12px 0}
input,button{font-size:16px;padding:6px 10px}
.bar{height:10px;background:#333;border-radius:4px;margin:2px 0}
.bar.now{background:#ffd700}
.month{border-left:4px solid #ffd700;padding-left:8px;margin:6px 0}
.line{margin-top:8px;padding:6px;border-radius:6px}
.career{background:#223344}
.health{background:#332222}
.relation{background:#223322}
small{color:#aaa}
</style>
</head>
<body>

<h1>çš‡æ¥µç¶“ä¸–ãƒ»ä¸‰ç·šæ™‚é–“å‹•èƒ½ç³»çµ±</h1>

<div class="card">
  å‡ºç”Ÿå¹´ï¼š
  <input id="birthYear" type="number" value="1975">
  <button onclick="run()">è¨ˆç®—</button>
</div>

<div id="result"></div>
<div id="timeline"></div>
<div id="monthly"></div>

<script>
/* ===== å‹¢æ®µ ===== */
const PHASES=[
  {name:"ç”Ÿ",range:[1,10],core:"å•Ÿå‹•"},
  {name:"ç››",range:[11,20],core:"æ“´å¼µ"},
  {name:"æ¥µç››",range:[21,30],core:"é«˜å³°"},
  {name:"è½‰",range:[31,40],core:"è½‰å‹"},
  {name:"è¡°",range:[41,50],core:"æ”¶æ–‚"},
  {name:"è—",range:[51,60],core:"è“„å‹¢"}
];

/* ===== çš‡æ¥µå…­åå¦ä½ ===== */
const HEX60=Array.from({length:60},(_,i)=>{
  const idx=i+1;
  const p=PHASES.find(x=>idx>=x.range[0]&&idx<=x.range[1]);
  return{
    index:idx,
    phase:p.name,
    core:p.core
  };
});

/* ===== æœˆå‹¢èƒ½ ===== */
const MONTH_ENERGY=[-5,-3,-1,1,3,5,6,4,2,0,-2,-4];

/* ===== ç”Ÿè€ç—…æ­» ===== */
function lifeState(e){
  if(e>=5)return"ç”Ÿ";
  if(e>=2)return"ç››";
  if(e>=0)return"è½‰";
  if(e>=-2)return"ç—…";
  return"æ­»";
}

/* ===== å‹¢èƒ½è­¦å‘Š ===== */
function warn(p,n){
  if(p<0&&n>0)return"ğŸŒ± å‹¢èµ·ï¼šå¯å•Ÿå‹•";
  if(p>0&&n===0)return"âš ï¸ è½‰é—œï¼šå‹¿ç¡¬æ¨";
  if(p>0&&n<0)return"â›” å‹¢çµ•ï¼šå¿…é ˆæ”¶";
  return"";
}

/* ===== ä¸‰ç·šè½‰æ› ===== */
function lineEnergy(e){
  return{
    career:e,
    health:e*0.7-1,
    relation:e*0.8
  };
}

/* ===== ä¸»é‹ç®— ===== */
function run(){
  const birth=+document.getElementById("birthYear").value;
  const nowY=new Date().getFullYear();
  const age=nowY-birth;

  const birthIdx=52; // 1975 éŒ¨é»
  let pos=(birthIdx+age)%60;
  if(pos===0)pos=60;
  const hex=HEX60[pos-1];

  document.getElementById("result").innerHTML=`
    <div class="card">
      <h2>äººç”Ÿå®šä½</h2>
      <p>${nowY}ï½œ${age} æ­²</p>
      <p><b>ç¬¬ ${hex.index} å¦ï½œå‹¢ï¼š${hex.phase}</b></p>
      <p>${hex.core}</p>
    </div>
  `;

  drawTimeline(hex.index);
  drawMonthly();
}

/* ===== æ™‚é–“è»¸ ===== */
function drawTimeline(now){
  let h=`<div class="card"><h3>äººç”Ÿ 60 å¦</h3>`;
  for(let i=1;i<=60;i++){
    h+=`<div class="bar ${i===now?"now":""}"></div>`;
  }
  h+=`</div>`;
  document.getElementById("timeline").innerHTML=h;
}

/* ===== ä¸‰ç·šæœˆä»½ ===== */
function drawMonthly(){
  let h=`<div class="card"><h3>12 æœˆä¸‰ç·šç‹€æ…‹</h3>`;
  MONTH_ENERGY.forEach((e,i)=>{
    const prev=i===0?0:MONTH_ENERGY[i-1];
    const L=lineEnergy(e);
    h+=`
      <div class="month">
        <b>${i+1} æœˆ</b>ï½œåŸå‹¢ ${e} ${warn(prev,e)?`<br><small>${warn(prev,e)}</small>`:""}
        <div class="line career">äº‹æ¥­ï¼š${lifeState(L.career)}ï¼ˆ${L.career.toFixed(1)}ï¼‰</div>
        <div class="line health">èº«é«”ï¼š${lifeState(L.health)}ï¼ˆ${L.health.toFixed(1)}ï¼‰</div>
        <div class="line relation">é—œä¿‚ï¼š${lifeState(L.relation)}ï¼ˆ${L.relation.toFixed(1)}ï¼‰</div>
      </div>
    `;
  });
  h+=`</div>`;
  document.getElementById("monthly").innerHTML=h;
}

run();
</script>
</body>
</html>
