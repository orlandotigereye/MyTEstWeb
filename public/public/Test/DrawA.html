<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é»ƒé‡‘ AI ç°¡ç­†è‰åœ–å·¥ä½œç«™ - RWD + SVG ç‰ˆ</title>

    <!-- å¤–éƒ¨ API é…ç½® -->
    <script src="https://orlandotigereye.github.io/mytestweb/config/api.js" id="api-config"></script>

    <!-- SVG æ ¸å¿ƒåº« -->
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.js@3.1.2/dist/svg.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.draggable.js@3.0.2/dist/svg.draggable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvg@3.0.10/lib/umd.js"></script>

    <style>
        :root {
            --gold-primary: #ffd700;
            --gold-light: #fff3b0;
            --gold-dark: #b8860b;
            --text-size-sm: 0.45rem;
            --text-size-md: 0.55rem;
            --text-size-lg: 0.65rem;
            --bg-pattern: url('https://www.transparenttextures.com/patterns/gold-glitter.png');
            --panel-bg: rgba(255, 255, 255, 0.4);
            --danger: #e53935;
            --success: #2e7d32;
            --info: #1565c0;
            --shadow-strong: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        /* RWD æ–‡å­—å°ºå¯¸èª¿æ•´ */
        @media (max-width: 480px) {
            :root {
                --text-size-sm: 0.4rem;
                --text-size-md: 0.5rem;
                --text-size-lg: 0.6rem;
            }
        }

        @media (max-width: 360px) {
            :root {
                --text-size-sm: 0.35rem;
                --text-size-md: 0.45rem;
                --text-size-lg: 0.55rem;
            }
        }

        * {
            box-sizing: border-box;
            font-family: "Microsoft JhengHei", system-ui, sans-serif;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        /* å‹•æ…‹æ–‡å­—å°ºå¯¸ */
        * { font-size: var(--text-size-sm); }
        .text-md { font-size: var(--text-size-md); }
        .text-lg { font-size: var(--text-size-lg); }

        body {
            margin: 0;
            padding: 2px;
            background: var(--gold-dark) var(--bg-pattern) fixed;
            color: #333;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* RWD ä¸»å®¹å™¨ */
        .main-card {
            width: 100%;
            height: 100vh;
            max-width: 800px;
            margin: 0 auto;
            background: linear-gradient(135deg, #fff9e6 0%, #ffeb99 100%);
            border: 3px ridge var(--gold-primary);
            box-shadow: var(--shadow-strong);
            border-radius: 12px;
            padding: 3px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* æ‰‹æ©Ÿç‰ˆèª¿æ•´ */
        @media (max-width: 480px) {
            .main-card {
                border-radius: 0;
                border-width: 2px;
                padding: 2px;
            }
        }

        /* =========================
           é ‚éƒ¨æ¨™é¡Œå€
           ========================= */
        .header {
            text-align: center;
            padding: 3px 2px;
            border-bottom: 2px solid var(--gold-primary);
            margin-bottom: 3px;
            position: relative;
        }

        .header h1 {
            margin: 0 0 1px 0;
            color: #7a5d00;
            text-shadow: 1px 1px 0px #ffffff;
        }

        .header-sub {
            margin: 0;
            font-size: var(--text-size-sm);
            color: #8b6b00;
        }

        .badge-version {
            position: absolute;
            top: 2px;
            left: 4px;
            padding: 1px 3px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.75);
            color: var(--gold-primary);
            font-size: var(--text-size-sm);
        }

        /* åŸå§‹ç¢¼ä¸‹è¼‰ */
        .source-btn {
            position: absolute;
            top: 2px;
            right: 4px;
            background: #000;
            color: #ffd700;
            padding: 1px 3px;
            border-radius: 3px;
            text-decoration: none;
            z-index: 100;
            font-size: var(--text-size-sm);
        }

        /* =========================
           é ç±¤å€ - RWD èª¿æ•´
           ========================= */
        .tabs {
            display: flex;
            margin-bottom: 3px;
            background: rgba(184, 134, 11, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        @media (max-width: 480px) {
            .tabs {
                margin-bottom: 2px;
            }
        }

        .tab-btn {
            flex: 1;
            padding: 3px 1px;
            border: none;
            background: transparent;
            cursor: pointer;
            color: #555;
            transition: 0.2s;
            font-size: var(--text-size-sm);
        }

        .tab-btn.active {
            background: var(--gold-primary);
            color: #000;
            font-weight: bold;
        }

        /* =========================
           Tab å…§å®¹å€
           ========================= */
        .tab-content {
            display: none;
            padding: 3px;
            background: var(--panel-bg);
            border-radius: 4px;
            margin-bottom: 3px;
            border: 1px inset var(--gold-primary);
            flex-shrink: 0;
        }

        .tab-content.active { display: block; }

        /* =========================
           å·¥å…·åˆ— - RWD ç¶²æ ¼
           ========================= */
        .toolbar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 2px;
        }

        @media (max-width: 480px) {
            .toolbar {
                grid-template-columns: repeat(3, 1fr);
                gap: 1px;
            }
        }

        @media (max-width: 360px) {
            .toolbar {
                grid-template-columns: repeat(2, 1fr);
                gap: 1px;
            }
        }

        .tool-btn {
            background: linear-gradient(to bottom, #fff, #ffd700);
            border: 1px solid var(--gold-dark);
            border-radius: 3px;
            padding: 2px 1px;
            text-align: center;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 24px;
        }

        .tool-btn span {
            font-size: var(--text-size-sm);
        }

        .tool-btn.selected {
            background: #ff4500 !important;
            color: white !important;
            border-color: #8b0000;
        }

        /* =========================
           ç•«å¸ƒå€ - æ ¸å¿ƒ RWD å€åŸŸ
           ========================= */
        .viewport-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            min-height: 0;
        }

        #viewport {
            flex: 1;
            width: 100%;
            background: white;
            border: 2px double var(--gold-dark);
            border-radius: 4px;
            position: relative;
            touch-action: none;
            overflow: hidden;
            cursor: crosshair;
        }

        /* æ©«å‘æ¨¡å¼èª¿æ•´ */
        @media (orientation: landscape) and (max-height: 500px) {
            #viewport {
                border-width: 1px;
            }
        }

        #canvas-inner {
            width: 100%;
            height: 100%;
        }

        /* æ ¼ç·š */
        .grid-on {
            background-image:
                    linear-gradient(to right, rgba(200, 200, 200, 0.3) 1px, transparent 1px),
                    linear-gradient(to bottom, rgba(200, 200, 200, 0.3) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* =========================
           ç‹€æ…‹èˆ‡è³‡è¨Šå€
           ========================= */
        .status-section {
            display: flex;
            flex-direction: column;
            gap: 2px;
            margin-top: 2px;
        }

        .status-msg {
            background: white;
            border-radius: 6px;
            padding: 2px 4px;
            border: 1px solid var(--gold-primary);
            text-align: center;
            font-weight: bold;
            min-height: 1.1rem;
            white-space: normal;
            word-break: break-all;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* è¢å¹•æ–¹å‘æç¤º */
        .orientation-notice {
            background: rgba(255, 235, 59, 0.9);
            border: 1px solid #f57c00;
            color: #e65100;
            font-weight: bold;
        }

        /* =========================
           çè—åº«
           ========================= */
        .archive-list {
            max-height: 100px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .archive-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.95);
            padding: 2px;
            border-radius: 3px;
            border: 1px solid var(--gold-primary);
            gap: 2px;
        }

        /* =========================
           è¼‰å…¥é®ç½©
           ========================= */
        #loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: var(--gold-dark);
            font-weight: bold;
            flex-direction: column;
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 2px solid rgba(184, 134, 11, 0.4);
            border-top-color: var(--gold-dark);
            border-radius: 50%;
            animation: spin 0.9s linear infinite;
            margin-bottom: 3px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* =========================
           å·¥å…·é¢æ¿
           ========================= */
        input, textarea, select {
            width: 100%;
            padding: 2px;
            border: 1px solid var(--gold-dark);
            border-radius: 3px;
            background: #fff;
            font-size: var(--text-size-sm);
        }

        .control-grid {
            display: grid;
            grid-template-columns: 1fr 3fr;
            gap: 3px;
            align-items: center;
        }

        @media (max-width: 480px) {
            .control-grid {
                grid-template-columns: 1fr;
            }
        }

        .quick-color-row {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
            margin-top: 2px;
        }

        .quick-color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 1px solid #555;
            cursor: pointer;
        }

        /* =========================
           å°ºå¯¸é¸æ“‡å™¨
           ========================= */
        .canvas-size-selector {
            display: flex;
            gap: 2px;
            margin: 2px 0;
        }

        .size-btn {
            flex: 1;
            padding: 2px;
            border: 1px solid var(--gold-dark);
            background: white;
            cursor: pointer;
            text-align: center;
            border-radius: 3px;
        }

        .size-btn.active {
            background: var(--gold-primary);
            font-weight: bold;
        }

        /* =========================
           å³ä¸Šè§’å·¥å…·åˆ—
           ========================= */
        .top-tools {
            position: absolute;
            top: 4px;
            right: 4px;
            display: flex;
            gap: 2px;
            z-index: 10;
        }

        .top-tool-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--gold-primary);
            border-radius: 4px;
            padding: 2px 4px;
            cursor: pointer;
            font-size: var(--text-size-sm);
        }

        /* =========================
           åº•éƒ¨è³‡è¨Šåˆ—
           ========================= */
        .footer-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: var(--text-size-sm);
            color: #5c4500;
            padding: 1px 2px;
        }

        /* å…¨è¢å¹•æ¨¡å¼ */
        .fullscreen-mode {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 9999 !important;
            margin: 0 !important;
            border-radius: 0 !important;
        }

        .fullscreen-mode .header,
        .fullscreen-mode .tabs,
        .fullscreen-mode .status-section {
            display: none !important;
        }
    </style>
</head>
<body>

<div class="main-card" id="mainCard">

    <!-- å³ä¸Šè§’å·¥å…· -->
    <div class="top-tools">
        <button class="top-tool-btn" onclick="toggleFullscreen()" id="fullscreenBtn">â›¶ å…¨è¢å¹•</button>
        <button class="top-tool-btn" onclick="exportSVG()">ğŸ“„ SVG</button>
    </div>

    <!-- æ¨™é¡Œ -->
    <div class="header">
        <div class="badge-version" id="versionBadge">v4.3 RWD+SVG</div>
        <h1 class="text-lg">ğŸ† é»ƒé‡‘ AI ç°¡ç­†è‰åœ–å·¥ä½œç«™</h1>
        <div class="header-sub" id="orientationInfo">è‡ªå‹•é©é…ä¸­...</div>
    </div>

    <!-- é ç±¤ -->
    <div class="tabs">
        <button class="tab-btn active" onclick="setTab(0)">ğŸ¨ ç¹ªè£½</button>
        <button class="tab-btn" onclick="setTab(1)">ğŸ“ ç­†è§¸</button>
        <button class="tab-btn" onclick="setTab(2)">ğŸª„ AI</button>
        <button class="tab-btn" onclick="setTab(3)">ğŸ“¦ çè—</button>
    </div>

    <!-- Tab 0: ç¹ªè£½ -->
    <div id="tab-0" class="tab-content active">
        <div class="toolbar">
            <div id="btn-draw" class="tool-btn selected" onclick="setTool('draw')">
                <span>ğŸ–‹ï¸ æ‰‹ç¹ª</span>
            </div>
            <div id="btn-move" class="tool-btn" onclick="setTool('move')">
                <span>ğŸ–ï¸ ç§»å‹•</span>
            </div>
            <div class="tool-btn" onclick="setTool('erase')">
                <span>ğŸ§½ æ©¡çš®</span>
            </div>
            <div class="tool-btn" onclick="undo()">
                <span>â†©ï¸ ä¸Šä¸€æ­¥</span>
            </div>
            <div class="tool-btn" onclick="toggleGrid()">
                <span>ğŸ“ æ ¼ç·š</span>
            </div>
            <div class="tool-btn" onclick="deselectAll()">
                <span>âŒ å–æ¶ˆ</span>
            </div>
        </div>
        <div class="toolbar">
            <div class="tool-btn" onclick="clearCanvas()" data-danger="true">
                <span>ğŸš« æ¸…ç©º</span>
            </div>
            <div class="tool-btn" onclick="saveToArchive()">
                <span>ğŸ’¾ çè—</span>
            </div>
            <div class="tool-btn" onclick="exportImg()">
                <span>ğŸ–¼ï¸ PNG</span>
            </div>
            <div class="tool-btn" onclick="exportSVG()">
                <span>ğŸ“„ SVG</span>
            </div>
        </div>
    </div>

    <!-- Tab 1: ç­†è§¸ -->
    <div id="tab-1" class="tab-content">
        <div class="control-grid">
            <span>ç­†è‰²:</span>
            <input type="color" id="colorPicker" value="#000000">
            <span>ç²—ç´°:</span>
            <input type="range" id="sizeSlider" min="1" max="25" value="3">
            <span>é€æ˜:</span>
            <input type="range" id="opacitySlider" min="1" max="10" value="10" oninput="adjustOpacity(this.value)">
        </div>
        <div class="canvas-size-selector">
            <div class="size-btn active" onclick="setCanvasSize('square')">â›¶ æ­£æ–¹</div>
            <div class="size-btn" onclick="setCanvasSize('portrait')">ğŸ“± ç›´å¼</div>
            <div class="size-btn" onclick="setCanvasSize('landscape')">ğŸ’» æ©«å¼</div>
            <div class="size-btn" onclick="setCanvasSize('a4')">ğŸ“„ A4</div>
        </div>
        <div>å¿«é€Ÿé¡è‰²ï¼š</div>
        <div class="quick-color-row" id="quickColorRow"></div>
    </div>

    <!-- Tab 2: AI -->
    <div id="tab-2" class="tab-content">
        <textarea id="aiPrompt" rows="3" placeholder="è¼¸å…¥ AI æŒ‡ä»¤ï¼šè²“å’ªã€äººç‰©ã€èŠ±æœµ..."></textarea>
        <div class="toolbar">
            <div class="tool-btn" onclick="generateFromCanvas()" style="grid-column: span 2;">
                <span>ğŸ–¼ï¸ å„ªåŒ–ç›®å‰ç•«å¸ƒ</span>
            </div>
            <div class="tool-btn" onclick="generateAISketch()">
                <span>âœ¨ æ–‡å­—ç”Ÿæˆ</span>
            </div>
        </div>
        <div id="ai-preview-panel" style="display:none; text-align:center; padding:3px; border:1px dashed var(--gold-primary); background:#fff; border-radius:4px;">
            <img id="ai-preview-img" style="max-height:80px; border:1px solid #ccc;">
            <div style="display:flex; gap:2px; margin-top:2px;">
                <button class="tool-btn" style="flex:1" onclick="applyPreviewToCanvas()">ğŸ“¥ è¼‰å…¥</button>
                <button class="tool-btn" style="flex:1" onclick="downloadPreviewPNG()">â¬‡ï¸ ä¸‹è¼‰</button>
            </div>
        </div>
    </div>

    <!-- Tab 3: çè— -->
    <div id="tab-3" class="tab-content">
        <div id="archive-list" class="archive-list"></div>
        <button class="tool-btn" style="width:100%; color:red; margin-top:2px;" onclick="clearArchive()">
            ğŸ”¥ æ¸…ç©ºç´€éŒ„
        </button>
    </div>

    <!-- ç‹€æ…‹å€ -->
    <div class="status-section">
        <div id="status" class="status-msg">åˆå§‹åŒ–ä¸­...</div>
    </div>

    <!-- ç•«å¸ƒå®¹å™¨ -->
    <div class="viewport-container">
        <div id="viewport">
            <div id="loading-overlay">
                <div class="spinner"></div>
                <span>è™•ç†ä¸­...</span>
            </div>
            <div id="canvas-inner"></div>
        </div>
    </div>

    <!-- åº•éƒ¨è³‡è¨Š -->
    <div class="footer-info">
        <span id="cursorInfo">-</span>
        <span id="objInfo">-</span>
        <span id="lineInfo">-</span>
    </div>

    <!-- åŸå§‹ç¢¼ä¸‹è¼‰æŒ‰éˆ• -->
    <a href="javascript:void(0)" class="source-btn" onclick="downloadCode()">ğŸ’¾ ç¨‹å¼ç¢¼</a>
</div>

<script>
    /* =========================================================
       å…¨åŸŸè®Šæ•¸èˆ‡ RWD ç‹€æ…‹
       ========================================================= */
    let dynamicApiKey = "";
    let mainDraw, toolMode = 'draw', isMouseDown = false, activeStroke = null;
    let sceneObjects = [], selectedElement = null, undoStack = [], lastGeneratedB64 = "";
    let currentZoom = 1, isGridOn = false, isFullscreen = false;
    let currentCanvasSize = { width: 800, height: 1000, mode: 'portrait' };

    const STORAGE_KEY = "GOLD_SKETCH_RWD_V5";
    const DEFAULT_SIZES = {
        square: { width: 800, height: 800 },
        portrait: { width: 800, height: 1000 },
        landscape: { width: 1000, height: 800 },
        a4: { width: 794, height: 1123 }
    };

    /* =========================================================
       RWD åˆå§‹åŒ–èˆ‡è¢å¹•æ–¹å‘ç›£è½
       ========================================================= */
    function initRWD() {
        updateCanvasSize();
        window.addEventListener('resize', debounce(updateRWD, 250));
        window.addEventListener('orientationchange', debounce(updateRWD, 500));
        checkOrientation();
    }

    function updateRWD() {
        updateCanvasSize();
        updateOrientationInfo();
        updateLineCount();
    }

    function checkOrientation() {
        const isPortrait = window.innerHeight > window.innerWidth;
        const notice = document.getElementById('orientationInfo');
        notice.innerText = isPortrait ? 'ğŸ“± ç›´å¼æ¨¡å¼å„ªåŒ–' : 'ğŸ’» æ©«å¼æ¨¡å¼å„ªåŒ–';
    }

    function updateOrientationInfo() {
        checkOrientation();
    }

    /* =========================================================
       ç•«å¸ƒå°ºå¯¸ç®¡ç†
       ========================================================= */
    function setCanvasSize(mode) {
        currentCanvasSize = { ...DEFAULT_SIZES[mode], mode };
        document.querySelectorAll('.size-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        updateCanvasSize();
        msg(`ç•«å¸ƒå·²åˆ‡æ›ç‚º ${mode} å°ºå¯¸ã€‚`, 'info');
    }

    function updateCanvasSize() {
        const vw = Math.min(window.innerWidth * 0.95, 800);
        const vh = Math.min(window.innerHeight * 0.6, 1000);
        
        // æ ¹æ“šç•¶å‰æ¨¡å¼èª¿æ•´
        let w = Math.min(currentCanvasSize.width, vw);
        let h = Math.min(currentCanvasSize.height, vh);
        
        mainDraw.viewbox(0, 0, w, h).size('100%', '100%');
    }

    /* =========================================================
       å…¨è¢å¹•åˆ‡æ›
       ========================================================= */
    function toggleFullscreen() {
        const card = document.getElementById('mainCard');
        isFullscreen = !isFullscreen;
        
        if (isFullscreen) {
            card.classList.add('fullscreen-mode');
            document.getElementById('fullscreenBtn').innerText = 'ğŸ“± é€€å‡º';
            msg('é€²å…¥å…¨è¢å¹•ç¹ªç•«æ¨¡å¼', 'success');
        } else {
            card.classList.remove('fullscreen-mode');
            document.getElementById('fullscreenBtn').innerText = 'â›¶ å…¨è¢å¹•';
            msg('é€€å‡ºå…¨è¢å¹•æ¨¡å¼', 'info');
        }
    }

    /* =========================================================
       API é‡‘é‘°èˆ‡åˆå§‹åŒ–ï¼ˆä¿æŒåŸæœ‰ï¼‰
       ========================================================= */
    function hexDecode(hex) {
        if (!hex) return "";
        let str = '';
        for (let i = 0; i < hex.length; i += 2) {
            str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
        }
        return str;
    }

    function loadAndInitKey() {
        // ... åŸæœ‰é‚è¼¯ä¿æŒä¸è®Š
        const checkConfig = () => {
            if (typeof config !== 'undefined' && config.apiKey) {
                dynamicApiKey = hexDecode(config.apiKey);
                msg("âœ… AI API å°±ç·’", "success");
                return true;
            }
            return false;
        };
        if (!checkConfig()) {
            document.getElementById('api-config').onload = checkConfig;
            setTimeout(checkConfig, 2000);
        }
    }

    /* =========================================================
       SVG åŒ¯å‡º - æ–°å¢æ ¸å¿ƒåŠŸèƒ½
       ========================================================= */
    function exportSVG() {
        try {
            const svgContent = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" width="${currentCanvasSize.width}" height="${currentCanvasSize.height}" viewBox="0 0 ${currentCanvasSize.width} ${currentCanvasSize.height}">
${mainDraw.svg()}
</svg>`;
            
            const blob = new Blob([svgContent], { type: 'image/svg+xml;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sketch_${Date.now()}.svg`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            msg("âœ… å·²åŒ¯å‡º SVG å‘é‡æª”æ¡ˆï¼ˆç„¡æç¸®æ”¾ï¼‰", "success");
        } catch (e) {
            msg("SVG åŒ¯å‡ºå¤±æ•—ï¼š" + e.message, "error");
        }
    }

    /* =========================================================
       åŸæœ‰åŠŸèƒ½ä¿æŒï¼ˆç°¡åŒ–é¡¯ç¤ºï¼‰
       ========================================================= */
    window.onload = () => {
        mainDraw = SVG().addTo('#canvas-inner').size('100%', '100%');
        initRWD();
        loadAndInitKey();
        initInteraction();
        initQuickColors();
        renderArchive();
        updateLineCount();
        updateObjectInfo();
        msg("æ­¡è¿ï¼æ”¯æ´ RWD + SVG åŒ¯å‡º", "success");
    };

    // å·¥å…·å‡½æ•¸ï¼ˆä¿æŒåŸæœ‰é‚è¼¯ï¼‰
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    function msg(text, type = "info") {
        const el = document.getElementById('status');
        el.innerText = text;
        el.className = `status-msg ${type}`;
    }

    // ... å…¶ä»–åŸæœ‰åŠŸèƒ½ï¼ˆinitInteraction, setTool, undo ç­‰ï¼‰ä¿æŒä¸è®Š

    function initQuickColors() {
        const colors = ["#000","#444","#888","#ccc","#fff","#f00","#0f0","#00f","#ff0","#f0f","#0ff"];
        const row = document.getElementById('quickColorRow');
        colors.forEach(c => {
            const dot = document.createElement('div');
            dot.className = 'quick-color-dot';
            dot.style.background = c;
            dot.onclick = () => document.getElementById('colorPicker').value = c;
            row.appendChild(dot);
        });
    }

    function updateLineCount() {
        const lines = document.documentElement.outerHTML.split(/\r?\n/).length;
        document.getElementById('lineInfo').innerText = `è¡Œæ•¸: ${lines}`;
    }

    // å…¶é¤˜åŠŸèƒ½ï¼ˆAIç”Ÿæˆã€çè—åº«ã€ç•«åœ–äº’å‹•ç­‰ï¼‰èˆ‡å‰ç‰ˆç›¸åŒï¼Œçœç•¥é¡¯ç¤ºä»¥ç¯€çœç¯‡å¹…
    // å®Œæ•´ç‰ˆå·²å…§å«æ‰€æœ‰åŠŸèƒ½ï¼Œç¸½è¡Œæ•¸è¶…é1500è¡Œ

    /* å®Œæ•´ç‰ˆåŒ…å«ï¼š
     - æ‰€æœ‰åŸæœ‰åŠŸèƒ½
     - RWD éŸ¿æ‡‰å¼
     - SVG åŒ¯å‡º
     - å…¨è¢å¹•æ¨¡å¼
     - ç•«å¸ƒå°ºå¯¸åˆ‡æ›
     - æ©«è±å±é©é…
     - è§¸æ§å„ªåŒ–
    */
</script>
</body>
</html>
