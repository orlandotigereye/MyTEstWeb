<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¹™å·³ä¸‰æ‰é›†æˆ V15 - è¦–è¦ºæ„è±¡ç‰ˆ</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://orlandotigereye.github.io/mytestweb/public/public/core.js"></script>
    <style>
        :root { --bg-gold: #FFFDE7; --main-gold: #D4AF37; --deep-gold: #B8860B; --coin-gold: #FFD700; --text-brown: #3E2723; --gold-grad: linear-gradient(135deg, #FFD700 0%, #FFF176 50%, #DAA520 100%); --font-size: 0.5rem; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'PingFang TC', sans-serif; background: var(--bg-gold); color: var(--text-brown); font-size: var(--font-size); width: 100vw; overflow-x: hidden; }
        header { height: 45px; background: var(--gold-grad); display: flex; justify-content: space-between; align-items: center; padding: 0 10px; border-bottom: 2px solid var(--deep-gold); font-weight: 900; }
        .nav-tabs { display: flex; background: #FFF; border-bottom: 1px solid var(--main-gold); }
        .tab { flex: 1; text-align: center; padding: 12px 0; font-weight: 900; color: #A68B5A; cursor: pointer; }
        .tab.active { background: rgba(255, 215, 0, 0.2); border-bottom: 3px solid var(--deep-gold); color: var(--text-brown); }
        .content { padding: 10px; }
        .page { display: none; } .page.active { display: block; }
        .card { background: #fff; border: 1.5px solid var(--coin-gold); border-radius: 8px; padding: 10px; margin-bottom: 10px; }
        textarea { width: 100%; height: 100px; border: 1.5px solid var(--main-gold); border-radius: 4px; padding: 8px; font-size: 0.5rem; }
        .btn-p { background: var(--gold-grad); border: 1px solid var(--deep-gold); color: var(--text-brown); font-weight: 900; padding: 12px; width: 100%; border-radius: 6px; cursor: pointer; margin-top: 10px; }
        
        /* æ„è±¡åœ–ç•«å¸ƒæ¨£å¼ */
        .visual-container { display: flex; flex-direction: column; gap: 10px; }
        .visual-card { 
            width: 300px; height: 180px; background: linear-gradient(145deg, #ffffff, #fff9c4); 
            border: 4px double var(--main-gold); border-radius: 12px; position: relative; 
            overflow: hidden; box-shadow: 4px 4px 15px rgba(0,0,0,0.1); padding: 15px; margin: 0 auto;
        }
        .visual-bg { position: absolute; top:-20px; right:-20px; font-size: 5rem; color: rgba(212, 175, 55, 0.1); font-weight: 900; z-index: 0; }
        .visual-header { border-bottom: 1px solid var(--main-gold); margin-bottom: 8px; font-weight: 900; display: flex; justify-content: space-between; z-index: 1; position: relative; }
        .visual-body { font-size: 0.6rem; z-index: 1; position: relative; color: #5D4037; height: 85px; }
        .visual-footer { font-size: 0.4rem; color: var(--deep-gold); border-top: 1px dashed var(--main-gold); padding-top: 5px; z-index: 1; position: relative; display: flex; align-items: center; }
        .logo-small { width: 15px; height: 15px; background: var(--gold-grad); border-radius: 50%; display: inline-block; margin-right: 5px; border: 1px solid var(--deep-gold); }

        .dl-btn { position: fixed; bottom: 10px; right: 10px; width: 45px; height: 45px; background: #000; color: #fff; border-radius: 50%; font-size: 0.4rem; z-index: 3000; border: 1px solid var(--coin-gold); text-align: center; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<header>ğŸ”± ä¹™å·³æ„è±¡é›†æˆ V15</header>

<nav class="nav-tabs">
    <div class="tab active" onclick="goTab(0)">æ¨æ¼”</div>
    <div class="tab" onclick="goTab(1)">æ„è±¡åœ–</div>
</nav>

<div class="content">
    <div id="p0" class="page active">
        <div class="card">
            <div style="display:flex; gap:5px; margin-bottom:5px;">
                <button class="btn-p" style="margin:0; flex:1;" onclick="paste()">ğŸ“‹ è²¼ä¸Š</button>
                <button class="btn-p" style="margin:0; flex:1; background:#f5f5f5;" onclick="clearIn()">ğŸ—‘ï¸ æ¸…ç©º</button>
            </div>
            <textarea id="main-in">æœ€è¿‘æ˜Ÿé«”: Mars
æœˆç›¸: ä¸‹å¼¦
å¹²æ”¯: ä¹™å·³ æˆŠå­ ä¸å¯ ç™¸å¯
äº”è¡Œ: æœ¨:20 ç«:50 åœŸ:10 é‡‘:5 æ°´:15
å­—å…¸é—œéµå­—: çŠ¯, æ©</textarea>
            <button class="btn-p" onclick="generateVisuals()">ğŸš€ ç”Ÿæˆä¸‰æ‰æ„è±¡åœ–</button>
        </div>
    </div>

    <div id="p1" class="page">
        <div class="visual-container" id="visual-output">
            <div class="visual-card" id="card-heaven">
                <div class="visual-bg">å¤©</div>
                <div class="visual-header"><span>ã€å¤©æ™‚ãƒ»æ˜Ÿå‘½å·ã€‘</span><span id="v1-score"></span></div>
                <div class="visual-body" id="v1-body"></div>
                <div class="visual-footer"><div class="logo-small"></div> ä¹™å·³å…¨é›†æˆ V15 èªè­‰</div>
            </div>
            <div class="visual-card" id="card-earth">
                <div class="visual-bg">åœ°</div>
                <div class="visual-header"><span>ã€åœ°æ°£ãƒ»å±€è®Šå·ã€‘</span><span id="v2-urg"></span></div>
                <div class="visual-body" id="v2-body"></div>
                <div class="visual-footer"><div class="logo-small"></div> ä¹™å·³å…¨é›†æˆ V15 èªè­‰</div>
            </div>
            <div class="visual-card" id="card-human">
                <div class="visual-bg">äºº</div>
                <div class="visual-header"><span>ã€äººé‹ãƒ»æ±ºç­–å·ã€‘</span><span id="v3-stage"></span></div>
                <div class="visual-body" id="v3-body"></div>
                <div class="visual-footer"><div class="logo-small"></div> ä¹™å·³å…¨é›†æˆ V15 èªè­‰</div>
            </div>
        </div>
        <button class="btn-p" onclick="exportAll()">ğŸ“¥ ä¸€éµå°å‡ºæ„è±¡åœ–é›†</button>
    </div>
</div>

<div class="dl-btn" onclick="downloadCode()">ä¸‹è¼‰<br>ä»£ç¢¼</div>

<script>
    const ECI_DB = {
        Stars: { "Mars": -7, "Saturn": -17, "Jupiter": 9, "Venus": 6, "Sun": 8 },
        Dict: { "çŠ¯": "æ°£å ´æ²–å‰‹ï¼Œå®œéœä¸å®œå‹•", "æ©": "éš±æ†‚é®è”½ï¼Œé˜²å°äººæš—ç®—", "å®ˆ": "æ ¹åŸºç©©å›ºï¼Œåˆ©æ–¼å®ˆæˆ" }
    };

    function goTab(i){ $('.page').removeClass('active'); $(`#p${i}`).addClass('active'); $('.tab').removeClass('active').eq(i).addClass('active'); }
    function clearIn(){ $('#main-in').val(''); }
    async function paste(){ const t = await navigator.clipboard.readText(); $('#main-in').val(t); }

    function generateVisuals() {
        const input = $('#main-in').val();
        
        // 1. å¤©æ™‚è¨ˆç®— (ä¹™å·³ V10.5)
        let heavenScore = 0;
        Object.entries(ECI_DB.Stars).forEach(([k,v]) => { if(input.includes(k)) heavenScore += v; });
        $('#v1-score').text(`å¾—åˆ†: ${heavenScore}`);
        $('#v1-body').html(`æ˜Ÿè±¡æ„Ÿæ‡‰ï¼š${heavenScore < 0 ? 'å¤©æ˜Ÿç¤ºè­¦ï¼Œæ°£æ•¸æ”¶æ–‚' : 'å¤©é™ç¥¥ç‘ï¼Œæ°£æ•¸å‡é¨°'}ã€‚<br>æ ¸å¿ƒå½±éŸ¿ï¼š${input.match(/æœ€è¿‘æ˜Ÿé«”: (.*)/)?.[1] || 'æœªçŸ¥'}é‹è½‰ä¸­ã€‚<br>é—œéµå­—ï¼š${Object.keys(ECI_DB.Dict).filter(k=>input.includes(k)).join(', ')}`);

        // 2. åœ°æ°£è¨ˆç®— (æ€¥ç·©åº¦)
        const urg = input.includes("ä¸‹å¼¦") ? "67% (æ€¥è®Š)" : "33% (ç·©é€²)";
        $('#v2-urg').text(`æŒ‡æ¨™: ${urg}`);
        $('#v2-body').html(`ç•¶å‰æœˆç›¸ï¼š${input.match(/æœˆç›¸: (.*)/)?.[1] || 'è§€æ¸¬ä¸­'}<br>åœ°æ°£èµ°å‘ï¼š${urg.includes("æ€¥") ? 'å‹•ç›ªé »ç¹ï¼Œé€Ÿæˆ°é€Ÿæ±º' : 'è¶¨å‹¢ç©©å®šï¼Œäº‹ç·©å‰‡åœ“'}ã€‚<br>å­—å…¸è¨»è§£ï¼š${Object.keys(ECI_DB.DB).filter(k=>input.includes(k)).map(k=>ECI_DB.Dict[k]).join('ï¼›')}`);

        // 3. äººé‹æ±ºç­– (God251224_J)
        const five = input.match(/ç«:(\d+)/)?.[1] || 0;
        $('#v3-stage').text(`æ±ºç­–æ¬Šé‡: ${five}%`);
        $('#v3-body').html(`<b>æ±ºç­–å»ºè­°ï¼š</b><br>${heavenScore < -5 ? 'ğŸ›‘ æš«ç·©åŸ·è¡Œï¼šç•¶å‰å¤©æ™‚ä¸åˆ©ï¼Œç›²ç›®æ“´å¼µå¿…æœ‰æå‚·ã€‚' : 'âœ… é †å‹¢è€Œè¡Œï¼šé›–ç„¶æœ‰æ³¢æŠ˜ï¼Œä½†æ ¹åŸºå°šå­˜ï¼Œå®œç©©æ­¥æ¨é€²ã€‚'}<br><b>äº”è¡Œæé†’ï¼š</b>ç«èƒ½è™•æ–¼ ${five}%ï¼Œé˜²æ€¥èºæƒ…ç·’èª¤äº‹ã€‚`);

        goTab(1);
    }

    async function exportAll() {
        const targets = ['card-heaven', 'card-earth', 'card-human'];
        for (let id of targets) {
            const canvas = await html2canvas(document.getElementById(id), { backgroundColor: null, scale: 2 });
            const link = document.createElement('a');
            link.href = canvas.toDataURL();
            link.download = `${id}_${Date.now()}.png`;
            link.click();
        }
    }

    function downloadCode(){ const b=new Blob([document.documentElement.outerHTML],{type:'text/html'}); const a=document.createElement('a'); a.href=URL.createObjectURL(b); a.download='Golden_Visual_V15.html'; a.click(); }
</script>
</body>
</html>
